{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Product directory","text":"<p>Explore guides and articles by product</p> <ul> <li> <p> <sup><sup>Home Automation</sup></sup> | HAOS on Hyper-V |</p> </li> <li> <p> <sup><sup>PSAppDeployToolkit</sup></sup> | Repository | Training | Support |</p> </li> <li> <p> <sup><sup>Windows</sup></sup> | Windows on OPi5 |</p> </li> </ul>"},{"location":"about/","title":"About","text":"<p>Welcome to docs.thetechguy.com, a resource for all things endpoint management, application packaging, and the occasional mad scientist-level  personal tech tinkering project! Here, we dive into the nuts and bolts of IT with the enthusiasm of a kid in a candy store\u2014except the candy  is made of code, scripts, and gadgets that may or may not have a mind of their own.</p>"},{"location":"about/#a-special-thank-you-to","title":"A special thank you to","text":"<ul> <li> <p>Martin Donath for Material for MkDocs</p> </li> <li> <p>Tim Vink for the following MkDocs plugins:</p> <ul> <li> <p>mkdocs-git-authors-plugin</p> </li> <li> <p>mkdocs-git-revision-date-localized-plugin</p> </li> </ul> </li> <li> <p>How to override templates by Ben</p> </li> <li> <p>Material for MkDocs Community</p> </li> </ul>"},{"location":"about/#disclaimer","title":"Disclaimer","text":"<p>The views and opinions expressed within article are those of the author and do not necessarily reflect the official policy or position of  their employer. In fact, their employer probably hasn't even read this and is likely blissfully unaware of the author\u2019s musings. If you have  any concerns or objections, please take them up with the author, preferably over a cup of coffee (or tea, if that's your thing).</p> <p>The author is not a spokesperson for their employer and is definitely not authorized to give away company secrets, promise salary raises,  or predict the next corporate merger. Please assume that anything you read here is the author\u2019s personal opinion, inspired by their own experience,  caffeine levels, and possibly a few late-night brainstorming sessions.</p> <p>If you\u2019re wondering whether the author\u2019s employer would agree with these opinions, the answer is probably a resounding, \u201cWho knows?\u201d Proceed  accordingly and enjoy the read!</p> <p>The content provided on docs.thetechguy.com, including programming examples, is for illustration purposes only and is provided \"as is,\"  without any warranty of any kind, either expressed or implied. This includes, but is not limited to, implied warranties of merchantability,  fitness for a particular purpose, and non-infringement. Basically, we're saying, \"Good luck, and may the debugging gods be ever in your favor!\"</p> <p>By using this website, you acknowledge that:</p> <ul> <li>You are familiar with the programming language and tools used to create and debug procedures. If not, we suggest making friends with someone  who is\u2014or at least buying them a pizza in exchange for their wisdom.</li> <li>You assume all responsibility for any outcomes resulting from the use of the provided examples. Yes, this includes but is not limited to  code-induced headaches, inexplicable computer behavior, and sudden urges to question your career choices.</li> </ul> <p>docs.thetechguy.com shall not be liable for any direct, indirect, incidental, special, exemplary, or consequential damages (including, but  not limited to, procurement of substitute goods or services; loss of use, data, or profits; or business interruption) however caused and on any  theory of liability, whether in contract, strict liability, or tort (including negligence or otherwise) arising in any way out of the use of this  content, even if advised of the possibility of such damage. In short, if your code catches fire, your laptop tries to run away, or your cat learns  to program, we're not responsible.</p>"},{"location":"blog/","title":"Blog","text":""},{"location":"homeautomation/","title":"Home Automation","text":"<ul> <li>Install Home Assistant OS on Hyper-V</li> </ul>"},{"location":"homeautomation/haos/install-haos-on-hyperv/","title":"Install HAOS on Hyper-V","text":"last updated: 2024-07-24"},{"location":"homeautomation/haos/install-haos-on-hyperv/#install-home-assistant-os-on-hyper-v","title":"Install Home Assistant OS on Hyper-V","text":"<p>This guide describes how to install the latest Home Assistant OS on Hyper-V.</p>"},{"location":"homeautomation/haos/install-haos-on-hyperv/#download-haos","title":"Download HAOS","text":"<ul> <li>Open HAOS release</li> <li>Scroll-down and download <code>haos_generic-aarch64-&lt;version&gt;.vmdk.zip</code></li> <li>Extract ZIP file</li> </ul>"},{"location":"homeautomation/haos/install-haos-on-hyperv/#convert-vmdk-to-vhdx","title":"Convert VMDK to VHDX","text":"<ul> <li>Download and install Microsoft Virtual Machine Converter</li> <li> <p>Open Powershell as an Administrator</p> <pre><code>Import-Module 'C:\\Program Files\\Microsoft Virtual Machine Converter\\MvmcCmdlet.psd1'\n\nConvertTo-MvmcVirtualHardDisk -SourceLiteralPath 'C:\\Temp\\haos_generic-aarch64-12.3.vmdk' -Destination 'C:\\Temp' -VhdType DynamicHardDisk -VhdFormat vhdx\n</code></pre> </li> <li> <p>Wait several minutes for the conversion to complete</p> </li> </ul>"},{"location":"homeautomation/haos/install-haos-on-hyperv/#create-virtual-machine","title":"Create virtual machine","text":"<p>Recommended Hardware</p> <ul> <li>2 CPUs</li> <li>2048 MB memory</li> <li>Disk: Move <code>haos_generic-aarch64.vhdx</code> under <code>Virtual Hard Disks</code> folder and select existing</li> </ul>"},{"location":"homeautomation/haos/install-haos-on-hyperv/#launch-home-assistant","title":"Launch Home Assistant","text":"<ul> <li>Start Virtual Machine</li> <li>Open <code>http://homeassistant.local:8123</code></li> </ul>"},{"location":"homeautomation/haos/install-haos-on-hyperv/#install-hacs-home-assistant-community-store","title":"Install HACS (Home Assistant Community Store)","text":"<p>Reference</p> <ul> <li>Install SSH add-on</li> <li>Set password</li> <li>Start SSH service</li> <li>Run <code>wget -O - https://get.hacs.xyz | bash -</code></li> <li>Navigate to Settings &gt; Devices &amp; Services &gt; Integrations</li> <li>Clear browser cache</li> <li>Hard reload browser using Shift-Refresh</li> <li>Click on + Add Integration</li> <li>Search for HACS and install</li> <li>Follow on-screen instructions</li> </ul>"},{"location":"homeautomation/haos/install-haos-on-hyperv/#add-integration","title":"Add Integration","text":"<ul> <li>Emporia Vue</li> <li>HomeKit Bridge</li> <li> <p>LG ThinQ Devices integration</p> <p>Note</p> <p>Go to the Integration tab and search the \"SmartThinQ LGE Sensors\" component</p> </li> <li> <p>Google Nest</p> </li> <li>Reolink IP NVR/camera</li> </ul>"},{"location":"homeautomation/haos/install-haos-on-hyperv/#add-automation-hardware","title":"Add Automation Hardware","text":"<ul> <li>Google Nest Learning Thermostat</li> <li>Emporia Smart Home Energy Monitor</li> <li>EMPORIA Smart Plug with Energy Monitoring</li> <li>ratgdo - Chamberlain or Liftmaster Opener</li> <li>meross Smart Light Switch 4</li> <li>meross Smart Ceiling Fan Control and Dimmer Light Switch</li> <li>meross Smart Water Sensor Alarm 3 Pack</li> <li>meross WiFi Thermometer Hygrometer</li> <li>Aqara Presence Sensor FP2</li> </ul>"},{"location":"homeautomation/haos/install-haos-on-hyperv/#add-security-hardware","title":"Add Security Hardware","text":"<ul> <li>REOLINK 4K 8CH Network Video Recorder</li> <li>REOLINK 5GHz WiFi Indoor Camera</li> <li>REOLINK RLC-1240A 12MP POE 145\u00b0 wide-angle view</li> <li>[REOLINK RLC-820A] 8MP POE 87\u00b0 view](https://amzn.to/46rfvbg)</li> <li>Cudy 8 Port Gigabit PoE Switch</li> </ul>"},{"location":"psadt/","title":"Index","text":"last updated: 2024-07-05"},{"location":"psadt/#what-is-psappdeploytoolkit","title":"What is PSAppDeployToolkit?","text":"<p>The PSAppDeployToolkit (PSADT) provides a set of functions to perform common application deployment tasks and to interact with the  user during a deployment. It simplifies the complex scripting challenges of deploying applications in the enterprise, provides a consistent  deployment experience and improves installation success rates.<sup>1</sup></p> <p> </p> <p>The PSAppDeployToolkit can be used to replace your WiseScript, VBScript and Batch wrapper scripts with one versatile, re-usable and extensible tool.</p>"},{"location":"psadt/#features","title":"Features","text":"<ul> <li>Easy To Use \u2013 Any PowerShell beginner can use the template and the functions provided with the Toolkit to perform application deployments.</li> <li>Consistent \u2013 Provides a consistent look and feel for all application deployments, regardless of complexity.</li> <li>Powerful \u2013 Provides a set of functions to perform common deployment tasks, such as installing or uninstalling multiple applications, prompting users to close apps, setting registry keys, copying files, etc.</li> <li>User Interface \u2013 Provides user interaction through customizable user interface dialogs boxes, progress dialogs and balloon tip notifications.</li> <li>Localized \u2013 The UI is localized in several languages and more can easily be added using the XML configuration file.</li> <li>Integration \u2013 Integrates well with ConfigMgr (SCCM) and Intune; provides installation and uninstallation deployment types with options on how to handle exit codes, such as suppressing reboots or returning a fast retry code.</li> <li>Updatable \u2013 The logic engine and functions are separated from per-application scripts, so that you can update the toolkit when a new version is released and maintain backwards compatibility with your deployment scripts.</li> <li>Extensible \u2013 The Toolkit can be easily extended to add custom scripts and functions.</li> <li>Helpful \u2013 The Toolkit provides detailed logging of all actions performed and even includes a graphical console to browse the help documentation for the Toolkit functions.</li> </ul>"},{"location":"psadt/#functionality","title":"Functionality","text":""},{"location":"psadt/#user-interface","title":"User Interface","text":"<ul> <li>An interface to prompt the user to close specified applications that are open prior to starting the application deployment. The user is  prompted to save their documents and has the option to close the applications themselves, have the toolkit close the running executables, or  optionally defer. Optionally, a countdown can be displayed until the applications are automatically closed.</li> <li>The ability to allow the user to defer an installation X number of times, X number of days or until a deadline date is reached.</li> <li>The ability to prevent the user from launching the applications that need to be closed while the application installation is in progress.</li> <li>An indeterminate progress dialog with customizable message text that can be updated throughout the deployment.</li> <li>A restart prompt with an option to restart later or restart now and a countdown to automatic restart.</li> <li>The ability to notify the user if disk space requirements are not met.</li> <li>Custom dialog boxes with options to customize title, text, buttons &amp; icon.</li> <li>Balloon tip notifications to indicate the beginning and end of an installation and the success or failure of an installation.</li> <li>Branding of the above UI components using a custom logo icon and banner for your own Organization.</li> <li>The ability to run in interactive, silent (no dialogs) or non-interactive mode (default for running task sequences or session 0).</li> <li>The UI is localized in several languages and more can easily be added using the XML configuration file.</li> </ul>"},{"location":"psadt/#functions-logic","title":"Functions / Logic","text":"<ul> <li>Provides extensive logging of both the Toolkit functions and any MSI installation / uninstallation.</li> <li>Provides the ability to execute any type of setup (MSI or EXEs) and handle / translate the return codes.</li> <li>Mass remove MSI applications with a partial match (e.g. remove all versions of all MSI applications which match \"Java\").</li> <li>Check for in-progress MSI installations and wait for MSI Mutex to become available.</li> <li>Send a sequence of keys to an application window.</li> <li>Perform ConfigMgr (SCCM) actions such as Machine and User Policy Refresh, Inventory Update and Software Update.</li> <li>Supports installation of applications on Citrix XenApp/Remote Desktop Session Host Servers.</li> <li>Update Group Policy.</li> <li>Copy / Delete Files.</li> <li>Get / Set / Remove Registry Keys and Values.</li> <li>Get / Set INI File Keys and Values.</li> <li>Check File versions.</li> <li>Pin or Unpin applications to the Start Menu or Taskbar.</li> <li>Create Start Menu Shortcuts.</li> <li>Test network connectivity.</li> <li>Test power connectivity.</li> </ul>"},{"location":"psadt/#configmgr-and-intune-integration","title":"ConfigMgr and Intune Integration","text":"<ul> <li>Handles proper exit codes, including time sensitive dialogs supporting Fast Retry feature \u2013 providing more accurate Reporting (no more Failed due to timeout errors).</li> <li>Ability to prevent reboot codes (3010) from being passed back, which would cause a reboot prompt.</li> <li>Supports the application model by providing an install and uninstall deployment type for every deployment script.</li> <li>Bundle multiple application installations to overcome the supported limit of 5 applications in the application dependency chain.</li> </ul>"},{"location":"psadt/#external-links","title":"External Links","text":"<ul> <li>PSAppDeployToolkit</li> </ul> <ol> <li> <p>PowerShell App Deploy Toolkit about page. \u21a9</p> </li> </ol>"},{"location":"psadt/support/","title":"Support","text":"<ul> <li>Discourse Forum</li> <li>Reddit</li> </ul>"},{"location":"psadt/training/","title":"Training","text":"<ul> <li> <p>PSAppDeployToolkit 101</p> </li> <li> <p>YouTube</p> </li> </ul>"},{"location":"windows/","title":"Windows","text":"<ul> <li>Windows 11 ARM on Orange Pi 5</li> </ul>"},{"location":"windows/windows11-arm/windows11arm-on-opi5/","title":"Windows 11 ARM on OPi5","text":"last updated: 2024-07-24"},{"location":"windows/windows11-arm/windows11arm-on-opi5/#windows-11-arm-on-opi5","title":"Windows 11 ARM on OPi5","text":"<p>This guide describes how to install the latest Windows 11 ARM image on an Orange Pi 5. Keep in mind this is still in development and individual results may vary.</p> <p> <p></p>"},{"location":"windows/windows11-arm/windows11arm-on-opi5/#hardware-requirements","title":"Hardware Requirements","text":"<ul> <li> <p>Orange Pi 5 (OPi5)</p> <p>Note</p> <p>OPi5 supports ARMv8.2. Windows 11 requires ARMv8.1</p> <p>As of June 2024, Orange Pi 5 Pro is not supported by this project.</p> </li> <li> <p>Heatsink with fan for Orange 5</p> </li> <li> <p>USB hub (uni USB C to USB Hub 4 Ports)</p> <p>Note</p> <p>USB hub is requires as only the vertical USB-A ports will work for keyboard and mouse. Any USB hub may work, this is just want I had. </p> </li> <li> <p>USB-C to USB-A adapter for hub</p> </li> <li> <p>NVMe drive (such as a SABRENT 1TB Rocket NVMe PCIe M.2 2242)</p> <p>Note</p> <p>Must be a NVMe M.2 drive. You may find some NVMe drives do not have driver support. I have found SABENT brand is supported. </p> <p>There is no driver support for All M.2 SATA drives.</p> </li> <li> <p>M.2 SSD screw set</p> </li> <li>Enclosure for M.2 PCIe NVMe</li> <li>USB keyboard and mouse</li> </ul>"},{"location":"windows/windows11-arm/windows11arm-on-opi5/#install-uefi-firmware-to-spi-nor-flash","title":"Install UEFI firmware to SPI NOR flash","text":"<p>Reference Guide (see Flash with Windows PC in section 4, option 2)</p> <p>Download</p> <ul> <li> <p>Download and extract latest version of RKDevTool</p> </li> <li> <p>Download, extract, and install latest version of Rockchip USB driver</p> </li> <li> <p>Download and extract latest release image of EDK2 UEFI firmware for orangepi-5 UEFI</p> <p>Note</p> <p>0.9.1 does not support built-in GMAC ethernet, use a newer build.</p> </li> <li> <p>Download latest SPL loader BIN file</p> </li> </ul> <p>Write firmware</p> <ul> <li> <p>Open RKDevTool as an Administrator</p> </li> <li> <p>Right-click in a blank space and select Load Config</p> <ul> <li>Select rock-5b-spinor.cfg</li> <li> <p>Click empty box under \u2026 to select file</p> <p>Note</p> <ul> <li>Rk3588_spl_loader.bin for Loader</li> <li>Orangepi-5_UEFI.img for Image</li> </ul> </li> <li> <p>Check Write by Address</p> </li> <li>Connect OPi5 from USB-C port to PC</li> </ul> </li> <li> <p>Hold down MARKROM button and connect USB-C power, wait a few seconds and release button</p> <p></p> </li> <li> <p>Status in RKDevTool should change from No Devices Found to Found One MASKROM Device</p> </li> <li> <p>Click Run</p> </li> <li> <p>Process is done when \"Download image OK\" is displayed in the logging pane. </p> <p>Note</p> <p>OPi5 will restarts by itself and exits MASKROM mode</p> </li> <li> <p>Disconnect from PC</p> </li> </ul>"},{"location":"windows/windows11-arm/windows11arm-on-opi5/#download-drivers","title":"Download Drivers","text":"<p>Driver download posts are pinned in the #development discord channel</p> <ul> <li>Download and extract RK3588 signed drivers<ul> <li>Current build</li> <li>Stable build</li> </ul> </li> <li>Download updated storage driver (pdb, inf, and sys)<ul> <li>Current build</li> </ul> </li> <li>Add updated drivers to rk3588_drivers ZIP file</li> </ul>"},{"location":"windows/windows11-arm/windows11arm-on-opi5/#download-windows-11-arm64-release-package","title":"Download Windows 11 arm64 release package","text":"<ul> <li> <p>Open uupdump</p> </li> <li> <p>Select arm64 build, I typically choose the latest public release build</p> <p> </p> </li> <li> <p>Select update</p> <p></p> </li> <li> <p>Choose language and click Next</p> </li> <li> <p>Uncheck Windows Home and click Next</p> </li> <li> <p>Select Download and convert to ISO</p> </li> <li> <p>Click Create download package</p> </li> <li> <p>Extract package to a folder that does not contain spaces in the path. Example: C:\\ISO</p> </li> </ul>"},{"location":"windows/windows11-arm/windows11arm-on-opi5/#generate-windows-iso","title":"Generate Windows ISO","text":"<ul> <li>Run <code>uup_download_windows.cmd</code></li> <li>Wait for files to be downloaded, processed, and ISO generated. Takes ~60-minutes.</li> </ul>"},{"location":"windows/windows11-arm/windows11arm-on-opi5/#install-windows-onto-nvme-drive","title":"Install Windows onto NVMe Drive","text":"<ul> <li> <p>Download and extract imager</p> <p>Note</p> <p>Ignore that it says Raspberry. This was original built for Raspberry Pi devices, but developer has been extended support to Orange Pi devices)</p> </li> <li> <p>Plug the NVMe drive into your PC</p> </li> <li>Run <code>WoR.exe</code> as an Administrator<ul> <li>Set wizard mode = Select show all options</li> <li>Select storage device and device type = Raspberry Pi 2/3</li> <li>Select ISO image and Windows Pro build</li> <li>For drivers, select the downloaded rk3588_drivers-v2.zip file</li> <li>For UEFI firmware, leave use the latest firmware. This doesn't really apply to OPi5.</li> <li>Leave defaults for configuration</li> <li>Click Install</li> <li>Wait for the Windows offline install to complete. Takes ~5 minutes</li> <li>Click Finish </li> </ul> </li> </ul>"},{"location":"windows/windows11-arm/windows11arm-on-opi5/#windows-setup","title":"Windows Setup","text":"<ul> <li>Install NVMe drive into the bottom of your OPi5</li> <li>Power-on OPi5</li> <li> <p>Wait for Windows to finish setup. Takes 30+ minutes.</p> <p>Note</p> <p>System may be slow while .NET Optimization runs </p> </li> <li> <p>Complete the OOBE process</p> </li> </ul>"},{"location":"windows/windows11-arm/windows11arm-on-opi5/#issues","title":"Issues","text":"<ul> <li>When booting the loading circle locks up and Windows never loads. After a few power cycles it clears.</li> </ul>"},{"location":"windows/windows11-arm/windows11arm-on-opi5/#thank-you","title":"Thank you","text":"<p>This guide wouldn't have been possible without Mario B\u0103l\u0103nic\u0103, the developers, and the community that supports the Windows on R project.</p> <ul> <li>Windows on R Project</li> <li>Windows on R Community Discord</li> </ul>"}]}